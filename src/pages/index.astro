---
import ComponentLayout from '../layouts/ComponentLayout.astro';
import StepCard from '../components/StepCard.astro';
import ProgressTracker from '../components/ProgressTracker.astro';
import CodeBlock from '../components/CodeBlock.astro';
import ValidationIndicator from '../components/ValidationIndicator.astro';
import CommandOutput from '../components/CommandOutput.astro';
import CollapsibleSection from '../components/CollapsibleSection.astro';
import NavigationButtons from '../components/NavigationButtons.astro';
---

<ComponentLayout
	title=""
	description="Interactive Tutorial Platform"
>

				<!-- ProgressTracker Demo -->
				<section class="mb-12">
					<h2 class="text-3xl font-bold text-text-primary mb-6">Progress Tracker</h2>

					<div class="space-y-6">
						<div>
							<h3 class="text-lg text-text-secondary mb-3">Just Started (30%)</h3>
							<ProgressTracker totalSteps={10} completedSteps={3} currentStep={4} />
						</div>

						<div>
							<h3 class="text-lg text-text-secondary mb-3">Half Complete (50%)</h3>
							<ProgressTracker totalSteps={20} completedSteps={10} />
						</div>

						<div>
							<h3 class="text-lg text-text-secondary mb-3">Almost Done (75%)</h3>
							<ProgressTracker totalSteps={8} completedSteps={6} currentStep={7} />
						</div>

						<div>
							<h3 class="text-lg text-text-secondary mb-3">Complete (100%)</h3>
							<ProgressTracker totalSteps={15} completedSteps={15} />
						</div>
					</div>
				</section>

				<!-- StepCard Demo -->
				<section class="mb-12">
					<h2 class="text-3xl font-bold text-text-primary mb-6">Step Cards</h2>

					<div class="space-y-4">
						<StepCard
							stepNumber={1}
							title="Install Dependencies"
							description="Install all required packages and dependencies for the dstack platform."
							status="completed"
						/>

						<StepCard
							stepNumber={2}
							title="Configure Server"
							description="Set up server configuration files and environment variables."
							status="in-progress"
						/>

						<StepCard
							stepNumber={3}
							title="Deploy Application"
							description="Deploy your first TEE application to the dstack network."
							status="pending"
						/>

						<StepCard
							stepNumber={4}
							title="Verify Attestation"
							status="pending"
						/>
					</div>
				</section>

				<!-- ValidationIndicator Demo -->
				<section class="mb-12">
					<h2 class="text-3xl font-bold text-text-primary mb-6">Validation Indicators</h2>

					<div class="space-y-2 bg-bg-card border border-border-default rounded-lg p-4">
						<ValidationIndicator label="Install system dependencies" checked={true} />
						<ValidationIndicator label="Build dstack-vmm from source" checked={true} />
						<ValidationIndicator label="Configure VMM settings" checked={false} />
						<ValidationIndicator label="Start VMM service" checked={false} />
						<ValidationIndicator label="Verify deployment" checked={false} />
					</div>
				</section>

				<!-- CommandOutput Demo -->
				<section class="mb-12">
					<h2 class="text-3xl font-bold text-text-primary mb-6">Command Output</h2>

					<div class="space-y-4">
						<CommandOutput
							output="Successfully built dstack-vmm v0.1.0"
							title="Build Success"
							type="success"
						/>

						<CommandOutput
							output={`Error: failed to compile vmm
   --> src/main.rs:42:5
    |
 42 |     println!("Missing semicolon")
    |                                  ^ expected ';'`}
							title="Build Error"
							type="error"
						/>

						<CommandOutput
							output="VMM service started on port 8090"
							type="info"
							showPrompt={true}
						/>

						<CommandOutput
							output={`Node version: v20.10.0
npm version: 10.2.3
Rust version: 1.75.0`}
							title="System Information"
						/>
					</div>
				</section>

				<!-- CollapsibleSection Demo -->
				<section class="mb-12">
					<h2 class="text-3xl font-bold text-text-primary mb-6">Collapsible Sections</h2>

					<div class="space-y-4">
						<CollapsibleSection title="Troubleshooting: Build Errors">
							<p class="mb-3">If you encounter build errors, try the following:</p>
							<ul class="list-disc list-inside space-y-2 text-text-secondary">
								<li>Ensure Rust toolchain is up to date: <code class="text-lime-green">rustup update</code></li>
								<li>Clean the build directory: <code class="text-lime-green">cargo clean</code></li>
								<li>Verify all dependencies are installed</li>
							</ul>
						</CollapsibleSection>

						<CollapsibleSection title="Common Issues" variant="warning" defaultOpen={true}>
							<p class="mb-3 text-yellow-500">⚠️ Known issues with TDX hardware:</p>
							<ul class="list-disc list-inside space-y-2 text-text-secondary">
								<li>Some BIOS versions require manual TDX enablement</li>
								<li>Kernel version 5.15+ is required for TDX support</li>
								<li>Check dmesg logs for TDX initialization errors</li>
							</ul>
						</CollapsibleSection>

						<CollapsibleSection title="Additional Information" variant="info">
							<p class="text-text-secondary">
								For more detailed documentation, visit the
								<a href="https://github.com/Dstack-TEE/dstack" class="text-cyber-blue hover:underline">dstack GitHub repository</a>.
								You can also join our community Discord for support.
							</p>
						</CollapsibleSection>
					</div>
				</section>

				<!-- NavigationButtons Demo -->
				<section class="mb-12">
					<h2 class="text-3xl font-bold text-text-primary mb-6">Navigation Buttons</h2>

					<div class="space-y-8">
						<div>
							<h3 class="text-lg text-text-secondary mb-3">Both Buttons Enabled</h3>
							<NavigationButtons
								previousUrl="/tutorial/step-1"
								previousLabel="Step 1: Introduction"
								nextUrl="/tutorial/step-3"
								nextLabel="Step 3: Configuration"
							/>
						</div>

						<div>
							<h3 class="text-lg text-text-secondary mb-3">First Page (Previous Disabled)</h3>
							<NavigationButtons
								nextUrl="/tutorial/step-2"
								nextLabel="Get Started"
							/>
						</div>

						<div>
							<h3 class="text-lg text-text-secondary mb-3">Last Page (Next Disabled)</h3>
							<NavigationButtons
								previousUrl="/tutorial/step-9"
								previousLabel="Step 9: Verification"
							/>
						</div>

						<div>
							<h3 class="text-lg text-text-secondary mb-3">Both Disabled (Standalone Page)</h3>
							<NavigationButtons />
						</div>
					</div>
				</section>

				<!-- CodeBlock Demo -->
				<section class="mb-12">
					<h2 class="text-3xl font-bold text-text-primary mb-6">Code Blocks</h2>

					<div class="space-y-6">
						<CodeBlock
							code="npm install dstack-cli"
							title="Install dstack CLI"
						/>

						<CodeBlock
							code={`# Build dstack VMM
cargo build --release

# Verify installation
./target/release/vmm --version`}
							language="bash"
							title="Build VMM from source"
						/>

						<CodeBlock
							code={`{
  "name": "my-tee-app",
  "version": "1.0.0",
  "dependencies": {
    "dstack-sdk": "^0.1.0"
  }
}`}
							language="json"
						/>
					</div>
				</section>
</ComponentLayout>
